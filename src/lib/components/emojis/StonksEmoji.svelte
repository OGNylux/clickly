<script lang="ts">
    import { animate, stagger, timeline, type AnimationControls } from "motion";
    import { onMount } from "svelte";

    export let animated = false;
    export let size = 64;

    const draw = (progress: number) => ({
          strokeDashoffset: 1 - progress,
          visibility: "visible",
    })
    
    let animation: AnimationControls | null = null;

    onMount(() => {
        animation = animate(".line", draw(1), { duration: 5, delay: stagger(0.1), repeat: Infinity });
    });

    $: if (!animated && animation) (animation as AnimationControls).pause();
       else if (animated && animation) (animation as AnimationControls).play();
</script>

<svg width={size} height={size} viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" class="filter drop-shadow">
    <path d="M31.7647 1.05859H4.23531C2.48084 1.05859 1.05884 2.48059 1.05884 4.23506V31.7645C1.05884 33.5189 2.48084 34.9409 4.23531 34.9409H31.7647C33.5192 34.9409 34.9412 33.5189 34.9412 31.7645V4.23506C34.9412 2.48059 33.5192 1.05859 31.7647 1.05859Z" fill="#B4BCC1"/>
    <path d="M31.7647 0H4.23529C1.89635 0 0 1.89635 0 4.23529V31.7647C0 34.1036 1.89635 36 4.23529 36H31.7647C34.1036 36 36 34.1036 36 31.7647V4.23529C36 1.89635 34.1036 0 31.7647 0ZM31.7647 2.11765C32.9326 2.11765 33.8824 3.06741 33.8824 4.23529V8.47059H27.5294V2.11765H31.7647ZM27.5294 19.0588H33.8824V25.4118H27.5294V19.0588ZM27.5294 16.9412V10.5882H33.8824V16.9412H27.5294ZM25.4118 2.11765V8.47059H19.0588V2.11765H25.4118ZM19.0588 10.5882H25.4118V16.9412H19.0588V10.5882ZM19.0588 19.0588H25.4118V25.4118H19.0588V19.0588ZM16.9412 2.11765V8.47059H10.5882V2.11765H16.9412ZM10.5882 10.5882H16.9412V16.9412H10.5882V10.5882ZM10.5882 19.0588H16.9412V25.4118H10.5882V19.0588ZM2.11765 4.23529C2.11765 3.06741 3.06741 2.11765 4.23529 2.11765H8.47059V8.47059H2.11765V4.23529ZM2.11765 10.5882H8.47059V16.9412H2.11765V10.5882ZM2.11765 19.0588H8.47059V25.4118H2.11765V19.0588ZM4.23529 33.8824C3.06741 33.8824 2.11765 32.9326 2.11765 31.7647V27.5294H8.47059V33.8824H4.23529ZM10.5882 33.8824V27.5294H16.9412V33.8824H10.5882ZM19.0588 33.8824V27.5294H25.4118V33.8824H19.0588ZM31.7647 33.8824H27.5294V27.5294H33.8824V31.7647C33.8824 32.9326 32.9326 33.8824 31.7647 33.8824Z" fill="#CCD6DD"/>
    <path class="line" pathLength="1" d="M3.94579 32.3103L3.94168 32.3081C3.64332 32.1477 3.52919 31.7739 3.69191 31.4711L11.1032 17.7074L11.1041 17.7057C11.1953 17.5357 11.3633 17.4172 11.5574 17.3886C11.7498 17.3604 11.9449 17.4249 12.0835 17.5635L18.517 23.9969L19.9596 25.4396L20.9064 23.6323L31.2172 3.94875L31.2174 3.94843C31.3758 3.64579 31.7489 3.53051 32.0484 3.68792L32.0511 3.68933C32.3516 3.84651 32.4699 4.21936 32.3107 4.52381L20.664 26.7582L20.6636 26.759C20.5743 26.9299 20.4086 27.0504 20.2142 27.0825C20.0083 27.1103 19.8113 27.0405 19.68 26.9092L19.68 26.9091L13.2211 20.4514L11.7955 19.026L10.8398 20.801L4.77913 32.0574L4.7789 32.0578C4.66903 32.262 4.45827 32.3824 4.23315 32.3824C4.13289 32.3824 4.03578 32.359 3.94579 32.3103Z" stroke="#DD2E44" stroke-width="3"/>
</svg>
    

<style>
    svg > * {
        transform-origin: center;
    }
    .line {
        fill: transparent;
        stroke: #DD2E44;
        stroke-width: 5px;
        stroke-dasharray: 1;
        stroke-dashoffset: 1;
        stroke-linecap: round;
        stroke-linejoin: round;
        visibility: hidden;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
    }
</style>
    